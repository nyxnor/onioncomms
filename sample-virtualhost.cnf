[distinguished_name]
countryName = GB
localityName = The Internet
organizationName = Your Organisation
organizationalUnitName = XMPP Department
commonName = TOR_HOSTNAME
emailAddress = xmpp@TOR_HOSTNAME

[req]
distinguished_name = distinguished_name
prompt = no
x509_extensions = selfsigned
req_extensions = certrequest

[certrequest]
extendedKeyUsage = serverAuth,clientAuth
keyUsage = digitalSignature,keyEncipherment
subjectAltName = @subject_alternative_name
basicConstraints = CA:FALSE

[selfsigned]
subjectAltName = @subject_alternative_name
basicConstraints = CA:TRUE

[subject_alternative_name]
DNS.0 = TOR_HOSTNAME
otherName.0 = 1.3.6.1.5.5.7.8.7;IA5STRING:_xmpp-client.TOR_HOSTNAME
otherName.1 = 1.3.6.1.5.5.7.8.7;IA5STRING:_xmpp-server.TOR_HOSTNAME
otherName.2 = 1.3.6.1.5.5.7.8.5;FORMAT:UTF8,UTF8:TOR_HOSTNAME